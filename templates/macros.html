<!-- BUTTONS -->


{%- macro link_button(text, link) -%}
<a class="button" href="{{ link }}">{{ text }}</a>
{%- endmacro -%}



{%- macro icon_link_button(icon, fb_text, link) -%}
<a class="icon button" href="{{ link }}" data-icon="{{ icon }}">{{ fb_text }}</a>
{%- endmacro -%}



<!-- 
    Second span in copy-tooltip is fix for firefox animation font bug
    https://bugzilla.mozilla.org/show_bug.cgi?id=1757017
-->
{%- macro copy_button(name, link) -%}

<div class="copy-button icon" onclick="CopyCode(event)" data-icon="content_copy">
    Copy <span class="copy-tooltip"><span></span></span>
</div>

{%- endmacro -%}



{%- macro settings_option(option_name) -%}
<hr><span class="line-block">{{ switch(option_name) }}{{ caller() }}</span>
{%- endmacro -%}



{%- macro icon(name, fallback) -%}
<span class="icon" data-icon="{{ name }}">{{ fallback }}</span>
{%- endmacro -%}



{%- macro invert_theme_button(name, link) -%}
{%- set mode = get_theme_mode(inverted=True) -%}
{%- set class = ("button", "theme-apply", "icon", g.theme, mode) | join(" ") -%}

{%- if g.use_js -%}
<div id="invert-theme-button" class="{{ class }}" onclick="invertTheme(event)">Aa</div>
{%- else -%}
<a 
    id="invert-theme-button"
    class="{{ class }}"
    href="{{ g.rpath.path }}?dark_mode={{ to_bool(not g.dark_mode) }}"
>Aa</a>
{%- endif -%}

{%- endmacro -%}



{%- macro set_theme_button(theme, mode) -%}
{%- set class = ("button", "theme-apply", theme, mode) | join(" ") -%}
{%- set dark_mode = to_bool(mode == "dark_mode") -%}

{%- if g.use_js -%}
<div class="{{ class }}" onclick="setTheme('{{ theme }}', '{{ mode }}')">Aa</div>
{%- else -%}
<a
    class="{{ class }}"
    href="{{ g.rpath.path }}?theme={{ theme }}&dark_mode={{ dark_mode }}"
>Aa</a>
{%- endif -%}

{%- endmacro -%}



<!-- SWITCHES AND SLIDERS -->


{%- macro switch(option) -%}
{%- set checked = "checked" if g[option] else "" -%}

<label class="switch">
{%- if g.use_js -%}
    <input type="checkbox" {{ checked }}
        onchange="switchOption(event, '{{ option }}')"
    >
    <div class="frame slider"></div>

{%- else -%}
    <input type="checkbox" {{ checked }}>
    <a
        class="frame slider"
        href="{{ g.rpath.path }}?{{ option }}={{ to_bool(g[option]) }}"
    ></a>

{%- endif -%}
</label>

{%- endmacro -%}



<!-- COMPLEX PAGE ELEMENTS -->


{%- macro highlight(language=None, filename=None) -%}
{%- set content = caller() -%}

{%- if g.use_hl -%}
<div class="highlight-block">
    <pre>{{ get_linenos(content) }}</pre>
    {{ copy_button() if g.use_js else "" }}
    <div class="highlight">
        <pre data-language="{{ language }}">
            {{-""-}}
            <code>{{ highlight_code(content, language, filename) }}</code>
            {{-""-}}
        </pre>
    </div>
</div>

{%- else -%}
<pre><code>{{ content }}</code></pre>
{%- endif -%}

{%- endmacro -%}



{%- macro breadcrumbs() -%}

<div class="breadcrumbs">
    {%- for name, link in g.rpath.breadcrumbs_links -%}
        {{- " / " -}}
        {%- if not loop.last -%}
            <a href="{{ link }}">{{ name }}</a>
        {%- elif g.rpath.is_not_found -%}
            <s>{{ name }}</s>
        {%- else -%}
            {{ name }}
        {%- endif -%}
    {%- endfor -%}
</div>

{%- endmacro -%}



{%- macro folder_file_list() -%}

<div class="file-list">
    <a class="button" href="{{ g.rpath.parent or '/' }}">
        {{- icon("drive_file_move_rtl", FOLDER_EMOJI) -}} ..
    </a>

    {%- for file in g.rpath.files -%}
        <a class="button" href="{{ g.rpath.path }}/{{ file.name }}">
            {%- if file.is_dir() -%}
                {{ icon("folder", FOLDER_EMOJI) }}
            {%- else -%}
                {{ icon("description", FILE_EMOJI) }}
            {%- endif -%}

            {{- file.name -}}
        </a>
    {%- endfor -%}
</div>

{%- endmacro -%}



{%- macro article_preview_block(articles_path="articles") -%}

<div class="preview-block">
    {%- for article in get_articles(articles_path) -%}
        {{ article.include() }}
    {%- endfor -%}
</div>

{%- endmacro -%}